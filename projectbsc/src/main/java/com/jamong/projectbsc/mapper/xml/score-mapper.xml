<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.jamong.projectbsc.mapper.ScoreMapper">
	
	<insert id="recordScore" parameterType="com.jamong.projectbsc.dto.Score">
		insert into
			scores(
				address,
				played_date,
				score
			)
			values (
				#{address},
				sysdate,				
				#{score}
			)
	</insert>
	
	<select id="getRank" resultType="map" parameterType="map">
		select
			u.id, u.address, max(s.score) "SCORE"
		from
			scores s
    	join
    		users u
		    on s.address = u.address
	    where
            1=1
        	and to_char(played_date) = to_char(sysdate)
        group by u.id, u.address
        order by 2 desc
	</select>
	
</mapper>